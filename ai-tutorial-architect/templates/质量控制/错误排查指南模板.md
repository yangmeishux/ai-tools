# 错误排查指南模板

> 适用于系统性排查和解决教程中的常见问题
> 质量目标：问题覆盖全面、排查步骤清晰、解决方案有效
> Agent 配置：Practitioner（主导）+ Learner-Advocate（辅助）+ Chief（审核）

---

## 🎭 Agent 协作流程

```
[@practitioner] 收集和分类教程中的常见错误
    ↓
[@learner-advocate] 从初学者角度补充潜在困惑点
    ↓
[@practitioner] 验证每个错误的复现条件和解决方案
    ↓
[@writer] 撰写排查步骤和解决方案
    ↓
[@editor] 优化表达结构，确保步骤清晰
    ↓
[@practitioner] 最终验证所有解决方案的有效性
    ↓
[Chief] 审核并定稿
```

---

## 📋 模板使用指南

### 适用场景
- ✅ 教程配套的 FAQ/故障排除章节
- ✅ 复杂环境配置的排错指南
- ✅ 常见错误速查手册
- ✅ 技术支持文档

### 不适用场景
- ❌ 简单到不可能出错的教程
- ❌ 概念讲解类内容
- ❌ 纯理论性文档

### 核心特点
- 🔍 **系统性**：分类清晰，便于快速定位
- 📝 **可操作性**：步骤详细，可一步步执行
- ✅ **验证性**：所有解决方案经过实际测试
- 💡 **预防性**：提供错误预防措施

---

# [教程名称] 错误排查指南

> 本教程常见问题的诊断与解决方案
> 
> 🔍 覆盖错误类型：[数量] 类 | ✅ 已验证方案：[数量] 个 | 📅 最后更新：YYYY-MM-DD

---

## 📑 快速定位索引

### 按错误阶段分类

| 阶段 | 常见错误 | 跳转链接 |
|------|----------|----------|
| 🛠️ **环境安装** | 安装失败、依赖冲突、权限问题 | [#环境安装问题](#一环境安装问题) |
| ⚙️ **配置设置** | 配置错误、路径问题、参数无效 | [#配置设置问题](#二配置设置问题) |
| 🚀 **启动运行** | 启动失败、端口占用、服务异常 | [#启动运行问题](#三启动运行问题) |
| 💻 **代码执行** | 语法错误、运行时异常、逻辑错误 | [#代码执行问题](#四代码执行问题) |
| 🔌 **网络连接** | 连接超时、API 错误、认证失败 | [#网络连接问题](#五网络连接问题) |
| 📊 **性能问题** | 运行缓慢、内存溢出、CPU 占用高 | [#性能问题](#六性能问题) |

### 按错误现象搜索

| 错误关键词 | 可能原因 | 解决方案 |
|------------|----------|----------|
| `[错误信息1]` | [原因] | [#解决方案](#) |
| `[错误信息2]` | [原因] | [#解决方案](#) |
| `[错误信息3]` | [原因] | [#解决方案](#) |

---

## 一、环境安装问题

### 1.1 安装失败

#### ❌ 错误现象

```
[错误信息示例]
Error: unable to install [package]
[详细错误堆栈]
```

**复现条件**：
- 操作系统：[系统版本]
- 执行命令：`[命令]`
- 网络环境：[网络状况]

#### 🔍 排查步骤

**步骤 1：检查网络连接**
```bash
# 测试网络连通性
[命令]

# 预期结果：[说明]
```

**步骤 2：检查权限**
```bash
# 查看当前用户
[命令]

# 检查目录权限
[命令]
```

**步骤 3：检查依赖**
```bash
# 查看已安装版本
[命令]

# 检查依赖冲突
[命令]
```

#### ✅ 解决方案

**方案 A：使用管理员权限**
```bash
# Windows（以管理员身份运行 PowerShell）
[命令]

# macOS/Linux
sudo [命令]
```
> **[@practitioner] 验证**：✅ 在 [环境] 下测试通过

**方案 B：更换镜像源**
```bash
# 设置国内镜像
[命令]

# 重新安装
[命令]
```
> **[@practitioner] 验证**：✅ 在 [环境] 下测试通过

**方案 C：手动安装依赖**
```bash
# 先安装依赖
[命令]

# 再安装主包
[命令]
```
> **[@practitioner] 验证**：✅ 在 [环境] 下测试通过

#### 🛡️ 预防措施

- [建议 1]
- [建议 2]
- [建议 3]

---

### 1.2 依赖版本冲突

#### ❌ 错误现象

```
[错误信息示例]
Conflict: [package-a] requires [package-b]@^1.0.0, but [package-c] requires [package-b]@^2.0.0
```

#### 🔍 排查步骤

**步骤 1：查看依赖树**
```bash
[命令]
```

**步骤 2：识别冲突点**
```bash
[命令]
```

#### ✅ 解决方案

**方案 A：使用兼容版本**
```bash
# 安装兼容的版本组合
[命令]
```

**方案 B：使用虚拟环境**
```bash
# 创建隔离环境
[命令]
```

---

## 二、配置设置问题

### 2.1 配置文件错误

#### ❌ 错误现象

```
[错误信息示例]
Error: Configuration file not found: config.yaml
```

#### 🔍 排查清单

- [ ] 配置文件是否存在？
- [ ] 配置文件路径是否正确？
- [ ] 配置文件格式是否正确？
- [ ] 配置项是否完整？

#### ✅ 解决方案

**配置文件模板**：
```yaml
# config.yaml 正确示例
[配置示例]
```

**验证配置**：
```bash
[验证命令]
```

---

### 2.2 环境变量问题

#### ❌ 错误现象

```
[错误信息示例]
Error: Environment variable [VAR_NAME] is not set
```

#### 🔍 排查步骤

**检查环境变量**：
```bash
# 查看所有相关环境变量
[命令]

# 检查特定变量
echo $[VAR_NAME]
```

#### ✅ 解决方案

**临时设置（当前终端）**：
```bash
export [VAR_NAME]=[value]
```

**永久设置**：
```bash
# 添加到 shell 配置文件
echo 'export [VAR_NAME]=[value]' >> ~/.bashrc
source ~/.bashrc
```

---

## 三、启动运行问题

### 3.1 端口占用

#### ❌ 错误现象

```
[错误信息示例]
Error: Port 3000 is already in use
```

#### 🔍 排查步骤

**查找占用端口的进程**：
```bash
# macOS/Linux
lsof -i :3000

# Windows
netstat -ano | findstr :3000
```

#### ✅ 解决方案

**方案 A：更换端口**
```bash
# 使用其他端口启动
[命令] --port 3001
```

**方案 B：结束占用进程**
```bash
# 找到 PID 后结束进程
kill -9 [PID]
```

---

### 3.2 服务启动失败

#### ❌ 错误现象

```
[错误信息示例]
Error: Failed to start service
[详细错误信息]
```

#### 🔍 排查流程

```
服务启动失败
    │
    ├─ 查看日志文件？
    │   ├─ 有错误信息 → 根据错误处理
    │   └─ 无日志 → 检查权限/资源
    │
    ├─ 检查端口占用？
    │   └─ 被占用 → 更换端口或结束进程
    │
    ├─ 检查依赖服务？
    │   └─ 数据库/缓存未启动 → 启动依赖
    │
    └─ 检查配置文件？
        └─ 配置错误 → 修正配置
```

---

## 四、代码执行问题

### 4.1 语法错误

#### ❌ 错误现象

```
[错误信息示例]
SyntaxError: Unexpected token '}'
```

#### 🔍 常见原因

| 错误类型 | 常见原因 | 示例 |
|----------|----------|------|
| 括号不匹配 | 缺少闭合括号 | `{` 没有 `}` |
| 引号不匹配 | 字符串未正确闭合 | `"string` |
| 缩进错误 | Python 缩进不一致 | 混用空格和 Tab |
| 关键字错误 | 拼写错误或误用 | `funtion` |

#### ✅ 解决方案

**使用代码检查工具**：
```bash
# 运行语法检查
[命令]
```

**IDE 自动修复**：
- [IDE 名称]：快捷键 `[快捷键]`
- [IDE 名称]：右键 → "格式化代码"

---

### 4.2 运行时错误

#### ❌ 错误现象

```
[错误信息示例]
TypeError: Cannot read property 'name' of undefined
```

#### 🔍 排查步骤

**步骤 1：定位错误位置**
```
根据错误堆栈信息，找到出错的文件和行号
```

**步骤 2：添加调试信息**
```javascript
// 在出错位置前添加日志
console.log('debug:', variable);
console.log('debug: typeof', typeof variable);
```

#### ✅ 解决方案

**空值检查**：
```javascript
// ❌ 不安全的写法
const name = user.name;

// ✅ 安全的写法
const name = user?.name || 'default';
```

---

## 五、网络连接问题

### 5.1 连接超时

#### ❌ 错误现象

```
[错误信息示例]
Error: connect ETIMEDOUT [address]
```

#### 🔍 排查步骤

**检查网络连通性**：
```bash
# 测试到目标地址的连通性
ping [address]

# 测试端口连通性
telnet [address] [port]
```

**检查代理设置**：
```bash
# 查看代理环境变量
echo $http_proxy
echo $https_proxy
```

#### ✅ 解决方案

**方案 A：检查防火墙**
```bash
# 临时关闭防火墙测试（仅用于诊断）
[命令]
```

**方案 B：配置代理**
```bash
# 设置代理
export http_proxy=http://proxy.example.com:8080
```

---

### 5.2 API 请求错误

#### ❌ 错误现象

```
[错误信息示例]
HTTP 404 Not Found
HTTP 401 Unauthorized
HTTP 500 Internal Server Error
```

#### 🔍 状态码速查

| 状态码 | 含义 | 常见原因 | 解决方案 |
|--------|------|----------|----------|
| 400 | 请求参数错误 | 参数缺失或格式错误 | 检查请求参数 |
| 401 | 未授权 | Token 失效或缺失 | 检查认证信息 |
| 403 | 禁止访问 | 权限不足 | 检查权限配置 |
| 404 | 资源不存在 | URL 错误或资源已删除 | 检查 URL |
| 500 | 服务器内部错误 | 服务端异常 | 联系服务端或重试 |
| 503 | 服务不可用 | 服务维护或过载 | 稍后重试 |

---

## 六、性能问题

### 6.1 运行缓慢

#### ❌ 现象描述

- [现象 1：启动时间超过 X 秒]
- [现象 2：请求响应时间超过 X 秒]
- [现象 3：页面加载时间超过 X 秒]

#### 🔍 诊断方法

**性能分析**：
```bash
# 查看资源占用
top / htop

# 查看磁盘 I/O
iostat

# 查看网络 I/O
iftop
```

#### ✅ 优化方案

**方案 A：增加资源**
```bash
# 增加内存分配
[命令] --memory=2g
```

**方案 B：启用缓存**
```bash
# 配置缓存
[配置示例]
```

---

### 6.2 内存溢出

#### ❌ 错误现象

```
[错误信息示例]
FATAL ERROR: Reached heap limit Allocation failed
```

#### ✅ 解决方案

**增加内存限制**：
```bash
# Node.js
node --max-old-space-size=4096 app.js

# Java
java -Xmx4g -jar app.jar
```

---

## 🛠️ 通用排查工具箱

### 诊断命令合集

```bash
# ========== 系统信息 ==========
# 查看操作系统版本
uname -a          # Linux/macOS
ver               # Windows

# 查看系统资源
free -h           # 内存
df -h             # 磁盘
du -sh [目录]      # 目录大小

# ========== 进程管理 ==========
# 查看进程
ps aux | grep [关键字]
top / htop

# 结束进程
kill -9 [PID]

# ========== 网络诊断 ==========
# 查看网络连接
netstat -tulpn    # Linux
netstat -ano      # Windows

# 测试连通性
ping [地址]
curl -v [URL]     # 详细请求信息

# ========== 文件操作 ==========
# 查找文件
find . -name "[文件名]"

# 查看文件内容
cat [文件]         # 全部
head -n 20 [文件]  # 前20行
tail -f [日志文件] # 实时跟踪
```

### 调试技巧

**1. 日志级别调整**
```bash
# 启用调试日志
[命令] --log-level=debug
DEBUG=* [命令]
```

**2. 最小化复现**
```bash
# 创建最小复现示例
# 1. 创建新的干净环境
# 2. 只安装必要的依赖
# 3. 运行最简化的代码
```

**3. 对比测试**
```bash
# 在另一台机器/环境中测试
# 对比差异，定位问题
```

---

## 📞 获取帮助

### 自助排查

1. **查看日志**：日志文件通常位于 `[路径]`
2. **搜索错误**：复制错误信息到搜索引擎
3. **查阅文档**：[官方文档链接]
4. **检查版本**：确认使用的是兼容版本

### 社区求助

- **GitHub Issues**：[链接]
- **Stack Overflow**：标签 `[标签名]`
- **官方论坛**：[链接]
- **Discord/微信群**：[加入方式]

### 提供有效信息

向他人求助时，请提供：
- [ ] 完整的错误信息（包括堆栈）
- [ ] 操作系统和版本
- [ ] 相关软件版本
- [ ] 复现步骤
- [ ] 已尝试的解决方案

---

## ✅ 错误排查指南检查清单

> **[@practitioner] 发布前验证**：

- [ ] 所有错误现象描述准确
- [ ] 所有解决方案经过实际测试
- [ ] 排查步骤逻辑清晰，无跳跃
- [ ] 覆盖教程中最常见的错误
- [ ] 提供了有效的预防措施
- [ ] 包含了必要的调试命令

---

*基于 AI Tutorial Architect 错误排查指南模板 v1.0.0*
*最后更新：2026-01-28*
